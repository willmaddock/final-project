<header class="bg-soft-white shadow-sm p-4">
  <div class="container">
    <div class="d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center">
        <%= image_tag 'logo.png', alt: 'Logo', width: 100, height: 50, class: 'me-3' %>
        <h1 class="h4 text-dark mb-0">AccessClearance Hub</h1>
      </div>
      <div class="d-flex align-items-center">
        <!-- Dark Mode Toggle -->
        <button id="dark-mode-toggle" class="btn btn-secondary me-3">Toggle Dark Mode</button>

        <!-- Account Dropdown -->
        <div class="dropdown">
          <button class="btn btn-light dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Account
          </button>
          <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <% if user_signed_in? %>
              <% if current_user.role == 'shipping_agent' || current_user.role == 'logistics_manager' %>
                <li>
                  <%= link_to 'Request Elevated Access', new_elevated_access_request_path, class: 'dropdown-item' %>
                </li>
              <% end %>
              <li>
                <%= link_to 'Logout', destroy_user_session_path, method: :delete, data: { turbo_method: :delete }, class: 'dropdown-item', aria: { label: 'Logout' } %>
              </li>
              <% if current_user.profile.nil? %>
                <li>
                  <%= link_to 'Create Profile', new_profile_path, class: 'dropdown-item' %>
                </li>
              <% else %>
                <li>
                  <%= link_to 'My Profile', profile_path(current_user.profile), class: 'dropdown-item' %>
                </li>
              <% end %>
            <% else %>
              <li>
                <%= link_to 'Sign In', new_user_session_path, class: 'dropdown-item' %>
              </li>
              <li>
                <%= link_to 'Sign Up', new_user_registration_path, class: 'dropdown-item' %>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>

    <% unless user_signed_in? %>
      <div class="mt-3 bg-light p-4 rounded border">
        <p class="text-dark">
          <strong>Congratulations!</strong> You have been approved to use the AccessClearance Hub, powered by leading Logistics and Cargo Operations companies.
          If you're a shipping agent or viewer, please sign in to access the tools essential for secure area access and to request elevated permissions when needed.
        </p>
        <p>
          Donâ€™t have an account? <%= link_to 'Sign up here', new_user_registration_path, class: 'text-primary' %> to get started.
        </p>
      </div>
    <% else %>
      <% if current_user.profile.nil? %>
        <div class="mt-3 bg-light p-4 rounded border">
          <p class="text-dark">
            Welcome back! Once you're logged in, we encourage you to create an optional profile that includes your bio, location, and an avatar. This will help us personalize your experience and make the platform more effective for you.
          </p>
          <p>
            <%= link_to 'Create your profile here', new_profile_path, class: 'text-primary' %> to get started.
          </p>
        </div>
      <% end %>
    <% end %>

    <nav class="mt-4">
      <ul class="nav">
        <li class="nav-item <%= 'active' if current_page?(users_path) %>">
          <%= link_to 'Users', users_path, class: 'nav-link text-dark' %>
        </li>
        <li class="nav-item <%= 'active' if current_page?(access_logs_path) %>">
          <%= link_to 'Access Logs', access_logs_path, class: 'nav-link text-dark' %>
        </li>
        <li class="nav-item <%= 'active' if current_page?(access_points_path) %>">
          <%= link_to 'Access Points', access_points_path, class: 'nav-link text-dark' %>
        </li>
        <li class="nav-item <%= 'active' if current_page?(profiles_path) %>">
          <%= link_to 'Profiles', profiles_path, class: 'nav-link text-dark' %>
        </li>
      </ul>
    </nav>
  </div>
</header>