<p style="color: green"><%= notice %></p>

<h1>Access Points</h1>

<%= link_to 'New Access Point', new_access_point_path, class: 'btn btn-primary mb-3' %>

<% if flash[:alert] %>
  <div class="alert alert-danger"><%= flash[:alert] %></div>
<% end %>

<% if flash[:notice] %>
  <div class="alert alert-success"><%= flash[:notice] %></div>
<% end %>

<!-- Filtering Form -->
<%= form_with(url: access_points_path, method: :get, local: true) do |form| %>
  <div class="form-row mb-3">
    <div class="col">
      <%= form.label :location, "Location:" %>
      <%= form.select :location, AccessPoint.select(:location).distinct.map { |ap| [ap.location, ap.location] }, { include_blank: 'Select Location' }, { class: 'form-control', onchange: 'this.form.submit();' } %>
    </div>
    <div class="col">
      <%= form.label :access_level, "Access Level:" %>
      <%= form.select :access_level, AccessPoint.select(:access_level).distinct.map { |ap| [ap.access_level, ap.access_level] }, { include_blank: 'Select Access Level' }, { class: 'form-control', onchange: 'this.form.submit();' } %>
    </div>
    <div class="col">
      <%= form.label :status, "Status:" %>
      <%= form.select :status, [['Active', true], ['Inactive', false]], { include_blank: 'Select Status' }, { class: 'form-control', onchange: 'this.form.submit();' } %>
    </div>
  </div>
  <div class="form-row mb-3">
    <div class="col">
      <%= form.submit 'Filter', class: 'btn btn-primary' %>
    </div>
  </div>
<% end %>

<!-- Records per Page Selector -->
<%= form_with(url: access_points_path, method: :get, local: true) do |form| %>
  <div class="form-group mb-3">
    <%= form.label :per_page, "Records per page:", class: "form-label" %>
    <%= form.select :per_page, [10, 20, 30], { selected: params[:per_page] || 10 },
                    { class: "form-select", onchange: 'this.form.submit();' } %>
  </div>
<% end %>

<div class="table-responsive">
  <table class="table table-striped">
    <thead>
    <tr>
      <th>Location</th>
      <th>Access Level</th>
      <th>Description</th>
      <th>Status</th>
      <th colspan="3" class="text-center">Actions</th>
    </tr>
    </thead>

    <tbody>
    <% @access_points.each do |access_point| %>
      <tr>
        <td><%= access_point.location %></td>
        <td><%= access_point.access_level %></td>
        <td><%= access_point.description %></td>
        <td><%= access_point.status ? 'Active' : 'Inactive' %></td>
        <td><%= link_to 'Show', access_point, class: 'btn btn-info' %></td>
        <td><%= link_to 'Edit', edit_access_point_path(access_point), class: 'btn btn-warning' %></td>
        <td>
          <%= link_to 'Destroy', access_point, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger' %>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>

<%= paginate @access_points %>